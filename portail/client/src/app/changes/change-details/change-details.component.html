<div class="card row active" id="detailspanel">
    <div id="details-panel-nav" style="width:100%;">
        <a id="detailspanel-close" href="#/changements" class="btn btn-outline-secondary btn-sm toggle">
            <b class="glyphicon glyphicon-remove">X</b>
        </a>
        <!-- Title -->
        <div class="card-header p-2 text-center" role="tab" id="headingDetailsPanel" style="word-wrap: break-word;">
            <b>Informations sur l'objet</b>
        </div>
        <div id="detailsContainer" *ngIf="mainChange" style="position:relative;">
        <div style="text-transform : capitalize;">
            <p style="text-align: left; width:50%; display: inline-block;">
                <a style="margin-left:10px;margin-right:5px;"><b>{{osmType}} {{osmId}}</b></a>
                <a class="logo" title="Voir l'objet sur openstreetmap.org" target="_blank" href="https://www.openstreetmap.org/{{osmType}}/{{osmId}}"><img src="assets/images/osm_logo_25px.png"></a>
            </p>

            <p style="text-align: right; width:50%;  display: inline-block;">
                <a title="Comparer les différentes versions sur OSM History Browser" target="_blank" href="http://osm.virtuelle-loipe.de/history/?type={{osmType}}&ref={{osmId}}"><span class="badge badge-info">History Browser</span></a>
                <a title="Comparer et visualiser les différentes versions sur OSM History Viewer" target="_blank" href="https://pewu.github.io/osm-history/#/{{osmType}}/{{osmId}}"><span class="badge badge-info">History Viewer</span></a>
            </p>
        </div>

        <div class="custom-slider" style="width:90%;margin: 0px auto 5px auto">
            <ng5-slider [hidden]="!displaySlider" 
                [(value)]="minValue"
                [(highValue)]="maxValue"
                [options]="options"
                (userChangeEnd)="onUserChangeEnd($event)"
                [manualRefresh]="manualRefresh"
                style="margin-bottom:30px;">
            </ng5-slider>
            <div *ngIf="noChangeInInterval" class="alert alert-danger" role="alert">
                Aucun changement dans l'intervalle considéré
            </div>
        </div>
        

            <div id="top_infos" style="background-color: rgba(255,255,255,0.3);">

                <div id="changeType">
                    <h4><span class="badge badge-secondary" [ngStyle]="{'background-color': changeType.relatedColor.getRGBA()}">{{changeType.name}}</span></h4>
                </div>

                <app-changes-detailled-map
                [hidden]="!userContext"
                [userContext]="userContext"
                [mainChange]="mainChange"
                id="MapChangement">
                </app-changes-detailled-map>


                <table class="table table-bordered" style="width:97%;line-height:0.8em;margin: 2px auto 5px auto">
                    <colgroup>
                        <col style="width:50%;">
                        <col style="width:50%;">
                    </colgroup>
                    <tbody>
                        <tr>
                            <th>Dernier timestamp (UTC)</th>
                            <td>{{timestampDate.toLocaleString('fr-FR', {timeZone: 'UTC'})}}</td>
                        </tr>
                        <tr *ngIf="lastUser">
                            <th style="vertical-align: middle;">Dernier user</th>
                            <td>
                                <a>{{lastUser}}</a>
                                <a class="logo" title="Voir l'utilisateur sur openstreetmap.org" target="_blank" href="https://www.openstreetmap.org/user/{{lastUser}}"><img src="assets/images/osm_logo_25px.png"></a>
                            </td>
                        </tr>
                        <tr *ngIf="lastChangeset" >
                            <th>Dernier changeset
                                <a class="metadata-circle" target="_blank" href="https://wiki.openstreetmap.org/wiki/FR:Groupes_de_modifications" title="Voir la définition sur le wiki"><b>?</b></a>
                            </th>
                            <td>
                                <a>{{lastChangeset}}</a>
                                <a class="logo" title="Voir le changeset sur openstreetmap.org" target="_blank" href="https://www.openstreetmap.org/changeset/{{lastChangeset}}"><img src="assets/images/osm_logo_25px.png"></a>
                                <a class="logo" title="Analyse du changeset sur OSMCha" target="_blank" href="https://osmcha.mapbox.com/changesets/{{lastChangeset}}/"><img src="https://osmcha.mapbox.com/favicon.ico" style="height:25px;width:25px;"></a>
                            </td>
                        </tr>
                        <tr *ngIf="transitionalChangesetArray && transitionalChangesetArray.length > 0">
                            <th>Changeset(s) intermédiaire(s)
                                <a class="metadata-circle" target="_blank" href="https://wiki.openstreetmap.org/wiki/FR:Groupes_de_modifications" title="Voir la définition sur le wiki"><b>?</b></a>
                            </th>
                            <td>
                                <ng-container *ngFor="let changeset of transitionalChangesetArray">
                                    <a>{{changeset}}</a>
                                    <a class="logo" title="Voir le changeset sur openstreetmap.org" target="_blank" href="https://www.openstreetmap.org/changeset/{{changeset}}"><img src="assets/images/osm_logo_25px.png"></a>
                                    <a class="logo" title="Analyse du changeset sur OSMCha" target="_blank" href="https://osmcha.mapbox.com/changesets/{{changeset}}/"><img src="https://osmcha.mapbox.com/favicon.ico" style="height:25px;width:25px;"></a>
                                </ng-container>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <table class="table table-hover table-bordered" id="tags">
                <colgroup>
                    <col style="width:30%">
                    <col *ngIf="mainChange.versionOld">
                    <col *ngIf="mainChange.versionNew">
                </colgroup>
                <thead>
                    <tr style="text-align: center">
                        <th>Version</th>
                        <th *ngIf="mainChange.versionOld">{{mainChange.versionOld}}</th>
                        <th *ngIf="mainChange.versionNew">{{mainChange.versionNew}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let tag of tagsList" [ngClass]="getHTMLTableClass(tag)">
                        <th>{{tag.key}}</th>
                        <!-- <td *ngIf="mainChange.versionOld">{{tag.valueOld.replace(deleteDoubleApostrophe,"'")}}</td>
                        <td *ngIf="mainChange.versionNew">{{tag.valueNew.replace(deleteDoubleApostrophe,"'")}}</td> -->
                        <td *ngIf="mainChange.versionOld">{{tag.valueOld ? tag.valueOld.replace(deleteDoubleApostrophe,"'") : ""}}</td>
                        <td *ngIf="mainChange.versionNew">{{tag.valueNew ? tag.valueNew.replace(deleteDoubleApostrophe,"'") : ""}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
